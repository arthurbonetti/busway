<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Busway - Rotas</title>
    <link rel="stylesheet" href="routes.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <div class="app-container">
        <nav class="navbar">
            <div class="nav-content">
                <div class="nav-left">
                    <button class="nav-back" onclick="window.history.back()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <div class="logo-container">
                        <svg class="logo-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M4 16c0 .88.39 1.67 1 2.22V20a1 1 0 001 1h1a1 1 0 001-1v-1h8v1a1 1 0 001 1h1a1 1 0 001-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4s-8 .5-8 4v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z" fill="#0071e3"/>
                        </svg>
                        <h1 class="logo">Busway</h1>
                    </div>
                </div>
                <div class="nav-right">
                    <button class="btn-financial" onclick="window.location.href='financial.html'" title="Controle Financeiro">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 100 7h5a3.5 3.5 0 110 7H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <button class="btn-notifications" onclick="toggleNotifications()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M18 8A6 6 0 106 8c0 7-3 9-3 9h18s-3-2-3-9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M13.73 21a2 2 0 01-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                    </button>
                    <button class="btn-profile" onclick="window.location.href='user-dashboard.html'">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                            <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </div>
        </nav>

        <div class="notifications-dropdown" id="notificationsDropdown" style="display: none;">
            <h3>Notificações</h3>
            <div id="notificationsList" class="notifications-list">
                <p class="no-notifications">Nenhuma notificação</p>
            </div>
        </div>

        <div class="main-content">
            <div class="route-selection-container">
                <h2>Selecione seu destino</h2>
                
                <div class="search-section">
                    <div class="input-group">
                        <label for="origin">Origem</label>
                        <div class="location-input">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" stroke="#0071e3" stroke-width="2"/>
                                <circle cx="12" cy="9" r="2" fill="#0071e3"/>
                            </svg>
                            <input type="text" id="origin" placeholder="Ex: Terminal Central, UFFS, Centro" value="Terminal Central" autocomplete="off">
                            <div class="suggestions-dropdown" id="originSuggestions"></div>
                        </div>
                    </div>

                    <div class="swap-locations">
                        <button onclick="swapLocations()" class="btn-swap">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M7 16l-4-4m0 0l4-4m-4 4h14m-4-8l4 4m0 0l-4 4m4-4H3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>

                    <div class="input-group">
                        <label for="destination">Destino</label>
                        <div class="location-input">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" stroke="#ef4444" stroke-width="2"/>
                                <circle cx="12" cy="9" r="2" fill="#ef4444"/>
                            </svg>
                            <input type="text" id="destination" placeholder="Ex: Efapi, São Cristóvão, Belvedere" autocomplete="off">
                            <div class="suggestions-dropdown" id="destinationSuggestions"></div>
                        </div>
                    </div>

                    <button class="btn-search" onclick="searchRoutes()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Buscar Rotas
                    </button>
                </div>

                <div class="filters-section">
                    <button class="filter-chip active" onclick="filterRoutes('all')">Todas</button>
                    <button class="filter-chip" onclick="filterRoutes('fastest')">Mais Rápidas</button>
                    <button class="filter-chip" onclick="filterRoutes('cheapest')">Mais Baratas</button>
                    <button class="filter-chip" onclick="filterRoutes('favorites')">Favoritas</button>
                </div>

                <div class="routes-list" id="routesList">
                    <div class="empty-state">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
                            <path d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 9m0 8V9m0 0L9 7" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <p>Digite um destino para ver as rotas disponíveis</p>
                    </div>
                </div>
            </div>

            <div class="tracking-section" id="trackingSection" style="display: none;">
                <div class="tracking-header">
                    <h3>Rastreamento em Tempo Real</h3>
                    <div class="tracking-controls">
                        <button class="btn-stop-all" onclick="stopAllTracking()" title="Parar Todos">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <rect x="6" y="6" width="12" height="12" stroke="currentColor" stroke-width="2" fill="currentColor"/>
                            </svg>
                            Parar Todos
                        </button>
                        <button class="btn-close" onclick="closeTracking()">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <!-- Lista de rastreamentos ativos -->
                <div class="active-trackings" id="activeTrackings" style="display: none;">
                    <h4>Linhas Ativas (<span id="activeCount">0</span>)</h4>
                    <div class="active-routes-list" id="activeRoutesList"></div>
                </div>
                
                <div class="map-container" id="mapContainer"></div>
                <div class="tracking-info">
                    <div class="info-item">
                        <span class="info-label">Linha:</span>
                        <span class="info-value" id="trackingLine">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Chegada prevista:</span>
                        <span class="info-value" id="trackingETA">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Próxima parada:</span>
                        <span class="info-value" id="trackingNextStop">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Velocidade:</span>
                        <span class="info-value" id="trackingSpeed">-</span>
                    </div>
                </div>
            </div>

            <div class="financial-section" id="financialSection" style="display: none;">
                <h3>Controle Financeiro</h3>
                <div class="balance-card">
                    <div class="balance-header">
                        <span>Saldo do Cartão</span>
                        <button class="btn-add-credit" onclick="openAddCreditModal()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M12 5v14m-7-7h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Adicionar
                        </button>
                    </div>
                    <div class="balance-amount">R$ <span id="balanceAmount">0,00</span></div>
                </div>

                <div class="transactions-list">
                    <h4>Últimas Transações</h4>
                    <div id="transactionsList"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="addCreditModal" style="display: none;">
        <div class="modal-content">
            <h3>Adicionar Crédito</h3>
            <div class="input-group">
                <label for="creditAmount">Valor (R$)</label>
                <input type="number" id="creditAmount" min="5" max="500" step="5" placeholder="0,00">
            </div>
            <div class="payment-methods">
                <label>
                    <input type="radio" name="paymentMethod" value="pix" checked>
                    PIX
                </label>
                <label>
                    <input type="radio" name="paymentMethod" value="credit">
                    Cartão de Crédito
                </label>
                <label>
                    <input type="radio" name="paymentMethod" value="boleto">
                    Boleto
                </label>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" onclick="closeAddCreditModal()">Cancelar</button>
                <button class="btn-primary" onclick="addCredit()">Adicionar</button>
            </div>
        </div>
    </div>

    <div class="notification-toast" id="notificationToast"></div>

    <script src="notification-system.js"></script>
    <script src="real-routes.js"></script>
    <script src="test-tracking.js"></script>
</body>
</html>